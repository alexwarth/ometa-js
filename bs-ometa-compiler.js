{BSOMetaParser=objectThatDelegatesTo(OMeta,{
"space":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return OMeta._superApplyWithArgs(this,'space')}),(function(){return this._applyWithArgs("fromTo","//","\n")}),(function(){return this._applyWithArgs("fromTo","/*","*/")}))},
"nameFirst":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return (function(){switch(this._apply('anything')){case "_":return "_";case "$":return "$";default: throw fail}}).call(this)}),(function(){return this._apply("letter")}))},
"nameRest":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return this._apply("nameFirst")}),(function(){return this._apply("digit")}))},
"tsName":function(){var $elf=this,_fromIdx=this.input.idx;return this._consumedBy((function(){this._apply("nameFirst");return this._many((function(){return this._apply("nameRest")}))}))},
"name":function(){var $elf=this,_fromIdx=this.input.idx;this._apply("spaces");return this._apply("tsName")},
"hexDigit":function(){var $elf=this,_fromIdx=this.input.idx,x,v;x=this._apply("char");v=this["hexDigits"].indexOf(x.toLowerCase());this._pred((v >= (0)));return v},
"eChar":function(){var $elf=this,_fromIdx=this.input.idx,s;return this._or((function(){s=this._consumedBy((function(){this._applyWithArgs("exactly","\\");return this._or((function(){return (function(){switch(this._apply('anything')){case "u":return (function(){this._apply("hexDigit");this._apply("hexDigit");this._apply("hexDigit");return this._apply("hexDigit")}).call(this);case "x":return (function(){this._apply("hexDigit");return this._apply("hexDigit")}).call(this);default: throw fail}}).call(this)}),(function(){return this._apply("char")}))}));return unescape(s)}),(function(){return this._apply("char")}))},
"tsString":function(){var $elf=this,_fromIdx=this.input.idx,xs;this._applyWithArgs("exactly","\'");xs=this._many((function(){this._not((function(){return this._applyWithArgs("exactly","\'")}));return this._apply("eChar")}));this._applyWithArgs("exactly","\'");return xs.join("")},
"characters":function(){var $elf=this,_fromIdx=this.input.idx,xs;this._applyWithArgs("exactly","`");this._applyWithArgs("exactly","`");xs=this._many((function(){this._not((function(){this._applyWithArgs("exactly","\'");return this._applyWithArgs("exactly","\'")}));return this._apply("eChar")}));this._applyWithArgs("exactly","\'");this._applyWithArgs("exactly","\'");return ["App","seq",xs.join("").toProgramString()]},
"sCharacters":function(){var $elf=this,_fromIdx=this.input.idx,xs;this._applyWithArgs("exactly","\"");xs=this._many((function(){this._not((function(){return this._applyWithArgs("exactly","\"")}));return this._apply("eChar")}));this._applyWithArgs("exactly","\"");return ["App","token",xs.join("").toProgramString()]},
"string":function(){var $elf=this,_fromIdx=this.input.idx,xs;xs=this._or((function(){(function(){switch(this._apply('anything')){case "#":return "#";case "`":return "`";default: throw fail}}).call(this);return this._apply("tsName")}),(function(){return this._apply("tsString")}));return ["App","exactly",xs.toProgramString()]},
"number":function(){var $elf=this,_fromIdx=this.input.idx,n;n=this._consumedBy((function(){this._opt((function(){return this._applyWithArgs("exactly","-")}));return this._many1((function(){return this._apply("digit")}))}));return ["App","exactly",n]},
"keyword":function(xs){var $elf=this,_fromIdx=this.input.idx;this._applyWithArgs("token",xs);this._not((function(){return this._apply("letterOrDigit")}));return xs},
"args":function(){var $elf=this,_fromIdx=this.input.idx,xs;return this._or((function(){return (function(){switch(this._apply('anything')){case "(":return (function(){xs=this._applyWithArgs("listOf","hostExpr",",");this._applyWithArgs("token",")");return xs}).call(this);default: throw fail}}).call(this)}),(function(){this._apply("empty");return []}))},
"application":function(){var $elf=this,_fromIdx=this.input.idx,rule,as,grm;return this._or((function(){this._applyWithArgs("token","^");rule=this._apply("name");as=this._apply("args");return ["App","super",(("\'" + rule) + "\'")].concat(as)}),(function(){grm=this._apply("name");this._applyWithArgs("token",".");rule=this._apply("name");as=this._apply("args");return ["App","foreign",grm,(("\'" + rule) + "\'")].concat(as)}),(function(){rule=this._apply("name");as=this._apply("args");return ["App",rule].concat(as)}))},
"hostExpr":function(){var $elf=this,_fromIdx=this.input.idx,r;r=this._applyWithArgs("foreign",BSSemActionParser,'expr');return this._applyWithArgs("foreign",BSJSTranslator,'trans',r)},
"curlyHostExpr":function(){var $elf=this,_fromIdx=this.input.idx,r;r=this._applyWithArgs("foreign",BSSemActionParser,'curlySemAction');return this._applyWithArgs("foreign",BSJSTranslator,'trans',r)},
"primHostExpr":function(){var $elf=this,_fromIdx=this.input.idx,r;r=this._applyWithArgs("foreign",BSSemActionParser,'semAction');return this._applyWithArgs("foreign",BSJSTranslator,'trans',r)},
"atomicHostExpr":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return this._apply("curlyHostExpr")}),(function(){return this._apply("primHostExpr")}))},
"semAction":function(){var $elf=this,_fromIdx=this.input.idx,x;return this._or((function(){x=this._apply("curlyHostExpr");return ["Act",x]}),(function(){this._applyWithArgs("token","!");x=this._apply("atomicHostExpr");return ["Act",x]}))},
"arrSemAction":function(){var $elf=this,_fromIdx=this.input.idx,x;this._applyWithArgs("token","->");x=this._apply("atomicHostExpr");return ["Act",x]},
"semPred":function(){var $elf=this,_fromIdx=this.input.idx,x;this._applyWithArgs("token","?");x=this._apply("atomicHostExpr");return ["Pred",x]},
"expr":function(){var $elf=this,_fromIdx=this.input.idx,x,xs;return this._or((function(){x=this._applyWithArgs("expr5",true);xs=this._many1((function(){this._applyWithArgs("token","|");return this._applyWithArgs("expr5",true)}));return ["Or",x].concat(xs)}),(function(){x=this._applyWithArgs("expr5",true);xs=this._many1((function(){this._applyWithArgs("token","||");return this._applyWithArgs("expr5",true)}));return ["XOr",x].concat(xs)}),(function(){return this._applyWithArgs("expr5",false)}))},
"expr5":function(ne){var $elf=this,_fromIdx=this.input.idx,x,xs;return this._or((function(){x=this._apply("interleavePart");xs=this._many1((function(){this._applyWithArgs("token","&&");return this._apply("interleavePart")}));return ["Interleave",x].concat(xs)}),(function(){return this._applyWithArgs("expr4",ne)}))},
"interleavePart":function(){var $elf=this,_fromIdx=this.input.idx,part;return this._or((function(){this._applyWithArgs("token","(");part=this._applyWithArgs("expr4",true);this._applyWithArgs("token",")");return ["1",part]}),(function(){part=this._applyWithArgs("expr4",true);return this._applyWithArgs("modedIPart",part)}))},
"modedIPart":function(){var $elf=this,_fromIdx=this.input.idx,part;return this._or((function(){this._form((function(){this._applyWithArgs("exactly","And");return this._form((function(){this._applyWithArgs("exactly","Many");return part=this._apply("anything")}))}));return ["*",part]}),(function(){this._form((function(){this._applyWithArgs("exactly","And");return this._form((function(){this._applyWithArgs("exactly","Many1");return part=this._apply("anything")}))}));return ["+",part]}),(function(){this._form((function(){this._applyWithArgs("exactly","And");return this._form((function(){this._applyWithArgs("exactly","Opt");return part=this._apply("anything")}))}));return ["?",part]}),(function(){part=this._apply("anything");return ["1",part]}))},
"expr4":function(ne){var $elf=this,_fromIdx=this.input.idx,xs,act;return this._or((function(){xs=this._many((function(){return this._apply("expr3")}));act=this._apply("arrSemAction");return ["And"].concat(xs).concat([act])}),(function(){this._pred(ne);xs=this._many1((function(){return this._apply("expr3")}));return ["And"].concat(xs)}),(function(){this._pred((ne == false));xs=this._many((function(){return this._apply("expr3")}));return ["And"].concat(xs)}))},
"optIter":function(x){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return (function(){switch(this._apply('anything')){case "*":return ["Many",x];case "+":return ["Many1",x];case "?":return ["Opt",x];default: throw fail}}).call(this)}),(function(){this._apply("empty");return x}))},
"optBind":function(x){var $elf=this,_fromIdx=this.input.idx,n;return this._or((function(){return (function(){switch(this._apply('anything')){case ":":return (function(){n=this._apply("name");return (function (){(this["locals"][n]=true);return ["Set",n,x]}).call(this)}).call(this);default: throw fail}}).call(this)}),(function(){this._apply("empty");return x}))},
"expr3":function(){var $elf=this,_fromIdx=this.input.idx,n,x,e;return this._or((function(){this._applyWithArgs("token",":");n=this._apply("name");return (function (){(this["locals"][n]=true);return ["Set",n,["App","anything"]]}).call(this)}),(function(){e=this._or((function(){x=this._apply("expr2");return this._applyWithArgs("optIter",x)}),(function(){return this._apply("semAction")}));return this._applyWithArgs("optBind",e)}),(function(){return this._apply("semPred")}))},
"expr2":function(){var $elf=this,_fromIdx=this.input.idx,x;return this._or((function(){this._applyWithArgs("token","~");x=this._apply("expr2");return ["Not",x]}),(function(){this._applyWithArgs("token","&");x=this._apply("expr1");return ["Lookahead",x]}),(function(){return this._apply("expr1")}))},
"expr1":function(){var $elf=this,_fromIdx=this.input.idx,x;return this._or((function(){return this._apply("application")}),(function(){x=this._or((function(){return this._applyWithArgs("keyword","undefined")}),(function(){return this._applyWithArgs("keyword","nil")}),(function(){return this._applyWithArgs("keyword","true")}),(function(){return this._applyWithArgs("keyword","false")}));return ["App","exactly",x]}),(function(){this._apply("spaces");return this._or((function(){return this._apply("characters")}),(function(){return this._apply("sCharacters")}),(function(){return this._apply("string")}),(function(){return this._apply("number")}))}),(function(){this._applyWithArgs("token","[");x=this._apply("expr");this._applyWithArgs("token","]");return ["Form",x]}),(function(){this._applyWithArgs("token","<");x=this._apply("expr");this._applyWithArgs("token",">");return ["ConsBy",x]}),(function(){this._applyWithArgs("token","@<");x=this._apply("expr");this._applyWithArgs("token",">");return ["IdxConsBy",x]}),(function(){this._applyWithArgs("token","(");x=this._apply("expr");this._applyWithArgs("token",")");return x}))},
"param":function(){var $elf=this,_fromIdx=this.input.idx,n;this._applyWithArgs("token",":");n=this._apply("name");return n},
"ruleName":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return this._apply("name")}),(function(){this._apply("spaces");return this._apply("tsString")}))},
"rule":function(){var $elf=this,_fromIdx=this.input.idx,n,x,xs;this._lookahead((function(){return n=this._apply("ruleName")}));(this["locals"]=({"$elf=this": true,"_fromIdx=this.input.idx": true}));(this["params"]=[]);x=this._applyWithArgs("rulePart",n);xs=this._many((function(){this._applyWithArgs("token",",");return this._applyWithArgs("rulePart",n)}));return ["Rule",n,this["params"],ownPropertyNames(this["locals"]),["Or",x].concat(xs)]},
"rulePart":function(rn){var $elf=this,_fromIdx=this.input.idx,n,p,b;n=this._apply("ruleName");this._pred((n == rn));this._or((function(){p=this._many((function(){return this._apply("param")}));this._applyWithArgs("token","=");(this["params"]=this["params"].concat(p));return b=this._apply("expr")}),(function(){return b=this._apply("expr")}));return b},
"grammar":function(){var $elf=this,_fromIdx=this.input.idx,n,sn,rs;this._applyWithArgs("keyword","ometa");n=this._apply("name");sn=this._or((function(){this._applyWithArgs("token","<:");return this._apply("name")}),(function(){this._apply("empty");return "OMeta"}));this._applyWithArgs("token","{");rs=this._applyWithArgs("listOf","rule",",");this._applyWithArgs("token","}");return this._applyWithArgs("foreign",BSOMetaOptimizer,'optimizeGrammar',["Grammar",n,sn].concat(rs))}});(BSOMetaParser["hexDigits"]="0123456789abcdef");BSOMetaTranslator=objectThatDelegatesTo(OMeta,{
"App":function(){var $elf=this,_fromIdx=this.input.idx,args,rule;return this._or((function(){return (function(){switch(this._apply('anything')){case "super":return (function(){args=this._many1((function(){return this._apply("anything")}));return [this["sName"],"._superApplyWithArgs(this,",args.join(","),")"].join("")}).call(this);default: throw fail}}).call(this)}),(function(){rule=this._apply("anything");args=this._many1((function(){return this._apply("anything")}));return ["this._applyWithArgs(\"",rule,"\",",args.join(","),")"].join("")}),(function(){rule=this._apply("anything");return ["this._apply(\"",rule,"\")"].join("")}))},
"Act":function(){var $elf=this,_fromIdx=this.input.idx,expr;expr=this._apply("anything");return expr},
"Pred":function(){var $elf=this,_fromIdx=this.input.idx,expr;expr=this._apply("anything");return ["this._pred(",expr,")"].join("")},
"Or":function(){var $elf=this,_fromIdx=this.input.idx,xs;xs=this._many((function(){return this._apply("transFn")}));return ["this._or(",xs.join(","),")"].join("")},
"XOr":function(){var $elf=this,_fromIdx=this.input.idx,xs;xs=this._many((function(){return this._apply("transFn")}));xs.unshift(((this["name"] + ".") + this["rName"]).toProgramString());return ["this._xor(",xs.join(","),")"].join("")},
"Seq":function(){var $elf=this,_fromIdx=this.input.idx,xs,y;return this._or((function(){xs=this._many((function(){return this._applyWithArgs("notLast","trans")}));y=this._apply("trans");xs.push(("return " + y));return xs.join(";")}),(function(){return "undefined"}))},
"And":function(){var $elf=this,_fromIdx=this.input.idx,xs;xs=this._apply("Seq");return ["(function(){",xs,"}).call(this)"].join("")},
"Opt":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._opt(",x,")"].join("")},
"Many":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._many(",x,")"].join("")},
"Many1":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._many1(",x,")"].join("")},
"Set":function(){var $elf=this,_fromIdx=this.input.idx,n,v;n=this._apply("anything");v=this._apply("trans");return [n,"=",v].join("")},
"Not":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._not(",x,")"].join("")},
"Lookahead":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._lookahead(",x,")"].join("")},
"Form":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._form(",x,")"].join("")},
"ConsBy":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._consumedBy(",x,")"].join("")},
"IdxConsBy":function(){var $elf=this,_fromIdx=this.input.idx,x;x=this._apply("transFn");return ["this._idxConsumedBy(",x,")"].join("")},
"JumpTable":function(){var $elf=this,_fromIdx=this.input.idx,cases;cases=this._many((function(){return this._apply("jtCase")}));return this.jumpTableCode(cases)},
"Interleave":function(){var $elf=this,_fromIdx=this.input.idx,xs;xs=this._many((function(){return this._apply("intPart")}));return ["this._interleave(",xs.join(","),")"].join("")},
"Rule":function(){var $elf=this,_fromIdx=this.input.idx,name,ps,ls,body;name=this._apply("anything");(this["rName"]=name);ps=this._apply("params");ls=this._apply("locals");this._or((function(){return this._form((function(){this._applyWithArgs("exactly","And");return body=this._apply("Seq")}))}),(function(){body=this._apply("trans");return body=["return ",body].join("")}));return ["\n\"",name,"\":function(",ps,"){",ls,body,"}"].join("")},
"Grammar":function(){var $elf=this,_fromIdx=this.input.idx,name,sName,rules;name=this._apply("anything");sName=this._apply("anything");(this["name"]=name);(this["sName"]=sName);rules=this._many((function(){return this._apply("trans")}));return [name,"=objectThatDelegatesTo(",sName,",{",rules.join(","),"})"].join("")},
"intPart":function(){var $elf=this,_fromIdx=this.input.idx,mode,part;this._form((function(){mode=this._apply("anything");return part=this._apply("transFn")}));return ((mode.toProgramString() + ",") + part)},
"jtCase":function(){var $elf=this,_fromIdx=this.input.idx,x,e;this._form((function(){x=this._apply("anything");return e=this._apply("trans")}));return [x.toProgramString(),e]},
"locals":function(){var $elf=this,_fromIdx=this.input.idx,vs;return this._or((function(){this._form((function(){return vs=this._many1((function(){return this._apply("string")}))}));return ["var ",vs.join(","),";"].join("")}),(function(){this._form((function(){undefined}));return ""}))},
"params":function(){var $elf=this,_fromIdx=this.input.idx,vs;return this._or((function(){this._form((function(){return vs=this._many1((function(){return this._apply("string")}))}));return vs.join(",")}),(function(){this._form((function(){undefined}));return ""}))},
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;this._form((function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}));return ans},
"transFn":function(){var $elf=this,_fromIdx=this.input.idx,x;this._or((function(){return this._form((function(){this._applyWithArgs("exactly","And");return x=this._apply("Seq")}))}),(function(){x=this._apply("trans");return x=["return ",x].join("")}));return ["(function(){",x,"})"].join("")}});(BSOMetaTranslator["jumpTableCode"]=(function (cases){var buf=new StringBuffer();buf.nextPutAll("(function(){switch(this._apply(\'anything\')){");for(var i=(0);(i < cases["length"]);(i+=(1))){buf.nextPutAll((((("case " + cases[i][(0)]) + ":return ") + cases[i][(1)]) + ";"))};buf.nextPutAll("default: throw fail}}).call(this)");return buf.contents()}))}